# ==============================================================================
# Script: 14c_Diagnostic.R
# Purpose: æ›å…‰ GSE70866 çš„çœŸå®ä¸´åºŠè¡¨å‹åˆ—å
# ==============================================================================

library(GEOquery)

# 1. ç›´æ¥è¯»å–ä½ å·²ç»ä¸‹è½½å¥½çš„æœ¬åœ°æ–‡ä»¶ (ç¬é—´åŠ è½½)
message("ğŸ“‚ æ­£åœ¨è¯»å–æœ¬åœ°æ•°æ®...")
save_path <- "~/ZHENGYINscRNAseqPROJECT/lianxi/00_data_raw"
gse <- getGEO("GSE70866", destdir = save_path, GSEMatrix = TRUE, AnnotGPL = TRUE)
pheno <- pData(gse[[1]])

# 2. æ‰“å°æ‰€æœ‰çš„åˆ—å (çœ‹çœ‹ä½œè€…åˆ°åº•å–äº†ä»€ä¹ˆå¥‡è‘©åå­—)
message("==================================================")
message("ğŸ” å‘ç°çš„ä¸´åºŠä¿¡æ¯åˆ—åå¦‚ä¸‹ï¼š")
print(colnames(pheno))
message("==================================================")

# 3. æ‰“å°ç¬¬ä¸€ä¸ªç—…äººçš„å‰å‡ åˆ—å…·ä½“å†…å®¹ (çœ‹ä¸ªæ ·æœ¬)
message("ğŸ‘¤ ç¬¬ä¸€ä¸ªç—…äººçš„å…·ä½“èµ„æ–™ï¼š")
print(t(pheno[1, 1:min(15, ncol(pheno))]))